# TCP vs UDP：传输层协议详解

网络传输层最核心的两个协议是 **TCP (Transmission Control Protocol)** 和 **UDP (User Datagram Protocol)**。它们在可靠性、速度和应用场景上有着本质的区别。

## 一、TCP (传输控制协议)

TCP 是一种**面向连接**的、**可靠**的、**基于字节流**的传输层通信协议。

### 核心特性
1.  **可靠性**: TCP 提供可靠的数据传输，确保数据按顺序到达目标，且不丢失。如果数据包在传输过程中丢失或损坏，TCP 会自动重新发送该数据包（重传机制）。
2.  **流控制**: TCP 拥有流控制机制（通过滑动窗口），用于控制发送者的发送速率，防止接收方处理不过来，导致网络拥塞。
3.  **连接导向**: TCP 是面向连接的协议，通信前必须先建立连接（三次握手），通信结束后需要释放连接（四次挥手）。这种机制确保了通信通道的可靠性和状态管理。
4.  **有序性**: TCP 保证数据包严格按照发送的顺序到达，接收方会进行重新排序，适用于对数据顺序要求严格的应用。

### 适用场景
适用于对 **数据完整性** 和 **可靠性** 要求较高的应用：
*   **网页浏览 (HTTP/HTTPS)**
*   **文件传输 (FTP)**
*   **电子邮件 (SMTP/IMAP/POP3)**
*   **远程登录 (SSH)**

---

## 二、UDP (用户数据报协议)

UDP 是一种**无连接**的传输层协议，它只负责发送数据包，不保证能够送达。

### 核心特性
1.  **无连接**: UDP 不需要建立和释放连接。每个数据包都是独立的，发送方发完即止，不维护连接状态。
2.  **不可靠性**: UDP 不提供可靠性保证。数据包可能会丢失、重复、乱序到达。UDP 不执行重传，也不进行拥塞控制。
3.  **低延迟**: 由于无需建立连接（无握手过程）和维护状态信息，且头部开销小（TCP 20字节 vs UDP 8字节），UDP 具有极低的延迟。
4.  **广播和多播**: UDP 支持广播和多播，允许将数据包一次性发送给所有或一组接收者，而 TCP 仅支持点对点传输。

### 适用场景
适用于 **实时性要求高**、**速度快**、**允许少量丢包** 的应用：
*   **音视频流媒体 (直播、视频会议)**
*   **在线游戏 (实时对战)**
*   **DNS 查询 (域名解析)**
*   **IoT 物联网通信**

---

## 三、总结与对比

| 特性 | TCP (传输控制协议) | UDP (用户数据报协议) |
| :--- | :--- | :--- |
| **连接性** | 面向连接 (三次握手) | 无连接 (直接发送) |
| **可靠性** | 高 (保证送达、重传、无差错) | 低 (可能丢包、乱序、重复) |
| **有序性** | 保证顺序 | 不保证顺序 |
| **速度/延迟** | 慢 (有连接建立和确认开销) | 快 (无连接，开销小) |
| **传输方式** | 字节流 | 数据报 |
| **流量/拥塞控制**| 有 | 无 |
| **头部开销** | 大 (20 字节) | 小 (8 字节) |

### 选择建议
*   **使用 TCP**: 当应用不能容忍数据丢失，必须保证数据完整和顺序时（如加载网页、传文件）。
*   **使用 UDP**: 当应用更关注速度和实时性，可以容忍少量卡顿或丢包时（如视频聊天、竞技游戏）。

> **注意**: 现代应用有时会混合使用，或基于 UDP 实现可靠传输（如 HTTP/3 的 QUIC 协议），以结合两者的优点。
