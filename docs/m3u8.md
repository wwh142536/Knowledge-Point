# M3U8 知识详解

## 1. M3U8 是什么

M3U8 是一种**基于文本的播放列表文件格式**，它是 M3U 格式的 UTF-8 编码版本。它专门用于 **HLS (HTTP Live Streaming)** 流媒体传输协议。

简单来说，M3U8 文件本身不包含视频数据，它只是一个索引文件，记录了一系列小视频片段（TS 文件）的地址和播放顺序。

## 2. M3U8 与 MP4 的区别

为什么大多数在视频流媒体传输中，常见的缓存文件是 M3U8 而不是 MP4？

### 区别对比

| 特性 | M3U8 | MP4 |
| :--- | :--- | :--- |
| **文件类型** | **索引文件** (Playlist) | **容器格式** (Container) |
| **用途** | 列出 TS 分片的播放顺序和路径 | 封装完整的音视频数据 |

### 选择 M3U8 的原因

1.  **更好的缓存 Strategy**: 
    *   M3U8 将大视频切分为小的 TS 片段。客户端可以只下载当前播放进度所需的片段，而不是整个大文件。
    *   **节省资源与空间**: 缓存的是 TS 片段，避免重复下载。
2.  **天然支持断点播放**:
    *   特别适合长视频和网络不稳定的场景。网络波动时，只需重新请求当前的小片段，而不用重新加载整个文件。
    *   支持自适应码率 (Adaptive Bitrate)，根据网速自动切换不同清晰度的分片。

## 3. 核心特点

1.  **切片存储**: 将一个大的视频文件分为多个小的 **TS (Transport Stream)** 文件片段。
2.  **加密保护**: 
    *   可以通过 **AES-128** 加密保护内容。
    *   加密块必须是 16 字节。不足 16 字节会有相应的补位方法；超过 16 字节则拆分成 N 块 16 字节，每块分别加密。
3.  **跨平台支持**: HLS 协议由 Apple 提出，现在已得到几乎全平台的支持。

## 4. 如何打开 M3U8 文件

由于 M3U8 是文本索引，普通视频播放器可能无法直接播放，通过以下方式可以预览：

### (1) App 播放 (移动端)
*   **iOS**: 内置 **Safari 浏览器** 或 NativePlayer 直接支持。
*   **Android**: 推荐 **MX Player** 或 **KMPlayer**。
*   **通用方案**: 使用集成了 HLS Player 专业版的应用。

### (2) 专业播放器 (桌面端)
*   **VLC Media Player**: 全平台免费，解码能力强。
*   **PotPlayer**: Windows 用户首选，功能强大。
*   **IINA**: Mac 用户首选，设计现代。

### (3) 浏览器支持
*   **PC 端**: 绝大部分 PC 浏览器的原生 `<video>` 标签**不支持**直接播放 M3U8，通常需要借助 JS 库（如 `hls.js` 或 `video.js`）来解码。
*   **特定浏览器**: Safari (Mac) 原生支持。
